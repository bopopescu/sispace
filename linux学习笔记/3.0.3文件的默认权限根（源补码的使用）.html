<html>
<head>
  <title>3.0.3文件的默认权限根（源补码的使用）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308859 (zh-CN, MWS); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1439"/>
<h1>3.0.3文件的默认权限根（源补码的使用）</h1>

<div>
<span><div><h2><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; line-height: normal;">补码的使用</span></h2><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 9pt; color: red; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">为什么我们创建的文件的权限是</span><span style="font-size: 9pt; color: red; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">644</span><span style="font-size: 9pt; color: red; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">呢？</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 9pt; color: red; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">我们创建文件的默认权限是怎么来的？</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt;">umask命令允许你设定文件创建时的缺省模式，对应每一类用户(文件属主、同组用户、其他用户)存在一个相应的umask值中的数字</span></div><div><span style="font-size: 9pt;">文件默认权限＝666 ，目录默认权限＝777</span></div><div><span style="font-size: 9pt;">我们一般在/etc/profile、$ [HOME]/.bash_profile或$[HOME]/.profile中设置umask值。</span></div><div><span style="font-size: 9pt;background-color: rgb(255, 250, 165);-evernote-highlight:true;">永久生效，编辑用户的配置文件vim .bash_profile</span></div><div>[root@xuegod63 ~]# vim /etc/profile【在60行左右，可见补码】</div></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 9pt; background-color: rgb(255, 250, 165); font-family: 微软雅黑, sans-serif; font-weight: bold;-evernote-highlight:true;-en-paragraph:true;">umask路径：</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="background-color: rgb(255, 250, 165); font-size: 9pt;-evernote-highlight:true;"><b><img src="3.0.3文件的默认权限根（源补码的使用）_files/Image.png" type="image/png" data-filename="Image.png"/></b></span><br/></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 9pt; background-color: rgb(255, 250, 165); font-family: 微软雅黑, sans-serif; font-weight: bold;-evernote-highlight:true;-en-paragraph:true;">临时生效</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">：</span> <span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">umask</span> <span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">权限补码</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt;">[root@xuegod63 ~]# umask 044</span></div><div><span style="font-size: 9pt;">[root@xuegod63 ~]# touch ss.txt</span></div><div><span style="font-size: 9pt;">[root@xuegod63 ~]# ll ss.txt</span></div><div><span style="font-size: 9pt;">-rw--w--w- 1 root root 0 5月   8 21:47 ss.txt</span></div></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt;">权限的算法：一般情况是：目录默认权限-umask 值</span></div><div><span style="font-size: 9pt;">666-022=644</span></div><div><span style="font-size: 9pt;">777-022=755</span></div><div><span style="font-size: 9pt;background-color: rgb(255, 250, 165);-evernote-highlight:true;">#这是一个好的记忆方法，但不严谨。</span></div></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 9pt; color: red; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">权限科学的计算方法：</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">1</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">、将默认权限（目录</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">777</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">，文件</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">666</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">）和</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">umask</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">值都转换为</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">2</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">进制</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">2</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">、对</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">umask</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">取反</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">3</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">、将默认权限和</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">umask</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">取反后的值做与运算</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">4</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">、将得到的二进制值再转换</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">8</span><span style="font-size: 9pt; font-family: 微软雅黑, sans-serif; font-weight: bold;-en-paragraph:true;">进制，即为权限，</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>例1： umask 为022</div><div>6  6  6            umask   0  2   2</div><div>110 110 110               000 010  010    # 转成二进制</div><div>                           111 101  101    # umask取反的值</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">110 110 110</span>    与              #第二步，默认权限和umask取反后的值做与运算</div><div>111 101 101   # umask取反的值</div><div>110 100 100</div><div>6   4   4     #转成8进制</div></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><div><br/></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 9pt;"><br/></span></div></div><div><br/></div></span>
</div></body></html> 