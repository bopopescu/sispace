<html>
<head>
  <title>docker镜像的制作</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308859 (zh-CN, MWS); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1392"/>
<h1>docker镜像的制作</h1>

<div>
<span><div><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">方法</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">1</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">：</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">docker commit</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif; mso-spacerun: yes;-en-paragraph:true;">  </span> <span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">#</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">保存</span> <span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">container</span> <span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">的当前状态到</span> <span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">image</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">后，然后生成对应的</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">image</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">创建一个安装好</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif; color: red;-en-paragraph:true;">apache</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">工具的容器镜像</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt;">[root@xuegod63 ~]# docker run -it docker.io/centos:latest /bin/bash</span></div><div><span style="font-size: 9pt;">[root@1d3563200047 /]# yum -y install  httpd   #在 container 中安装 apache 软件包</span></div><div><span style="font-size: 9pt;">[root@1d3563200047 /]# exit</span></div></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">查看</span> <span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">images</span> <span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">列表</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">[root@xuegod63 ~]# docker images</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt;">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span></div><div><span style="font-size: 9pt;">docker.io/centos    latest              196e0ce0c9fb        13 days ago         196.6 MB注：当前只有一个image centos</span></div></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif; color: red;-en-paragraph:true;">根据容器当前状态做一个</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif; color: red;-en-paragraph:true;">image</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif; color: red;-en-paragraph:true;">镜像：创建一个安装了</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif; color: red;-en-paragraph:true;">apache</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif; color: red;-en-paragraph:true;">工具的</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif; color: red;-en-paragraph:true;">centos</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif; color: red;-en-paragraph:true;">镜像</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">语法：</span> <span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">docker commit &lt;container</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">的</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">ID&gt;</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">或</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">&lt;image_name&gt;</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">例：</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">查看容器</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">ID</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">：</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">[root@xuegod63 ~]# docker ps -a</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                        PORTS               NAMES</div><div>1d3563200047        centos              &quot;/bin/bash&quot;              10 minutes ago      Exited (0) 6 minutes ago                          tender_joliot</div></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">[root@xuegod63 ~]# docker commit bbd01c4b8567 docker.io/centos:apache</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">输出为：sha256:e5917c01599c70d0680beeb35f6df98889dd22106399efd6907d956d8a943242</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">[root@xuegod63 ~]# docker images</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt;">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span></div><div><span style="font-size: 9pt;">docker.io/centos    apache              38fa5452c20d        5 seconds ago       304.3 MB</span></div><div><span style="font-size: 9pt;">docker.io/centos    latest              196e0ce0c9fb        13 days ago         196.6 MB</span></div></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">使用新创建的</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">docker.io/centos</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">：</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">apache</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">镜像，生成一台容器实例：</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">镜像，生成一台容器实例：</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt;">[root@xuegod63 ~]# docker run -it centos:apache /bin/bash</span></div><div><span style="font-size: 9pt;">[root@8b1afc920454 /]# rpm -qa httpd    #查看，已经安装好apache命令</span></div><div><span style="font-size: 9pt;">httpd-2.4.6-67.el7.centos.2.x86_64</span></div></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">注：说明基于</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">apache</span><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;">镜像的容器创建成功。</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: 微软雅黑, sans-serif;-en-paragraph:true;"><font style="font-size: 12pt;"><b>发布镜像：</b></font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt;">方法2：Push Image To Docker Hub  发布到外网</span></div><div><span style="font-size: 9pt;">1、Signup on docker hub &amp; create repo    注册一个帐号</span></div><div><span style="font-size: 9pt;">https://hub.docker.com/</span></div><div><span style="font-size: 9pt;">2、Login to docker hub</span></div><div><span style="font-size: 9pt;"># docker login -u userabc -p abc123 -e userab@gmail.com</span></div><div><span style="font-size: 9pt;">3、Push image to docker hub   #上传镜像</span></div><div><span style="font-size: 9pt;"># docker push centos:httpd</span></div><div><span style="font-size: 9pt;">4、Pull image from docker hub   #下载镜像</span></div><div><span style="font-size: 9pt;"># docker pull userabc/centos:httpd     #  用户名/镜像名</span></div></div></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; mso-bidi-font-weight: normal; font-size: 9.0pt; font-family: &quot;微软雅黑&quot;,sans-serif;-en-paragraph:true;"> </span><br/></div></span>
</div></body></html> 